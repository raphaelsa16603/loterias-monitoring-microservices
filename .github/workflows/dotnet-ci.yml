name: Build Core Libraries (.NET 8)

on:
  push:
    branches: [ main, develop, feature/** ]
  pull_request:
    branches: [ main, develop ]

jobs:
  build-core-libs:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup .NET 8 SDK
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: 8.0.x

      - name: Cache NuGet packages
        uses: actions/cache@v4
        with:
          path: ~/.nuget/packages
          key: ${{ runner.os }}-nuget-${{ hashFiles('**/packages.lock.json') }}
          restore-keys: |
            ${{ runner.os }}-nuget-

      # ðŸ§± Build Loterias.Shared
      - name: Restore dependencies (Loterias.Shared)
        run: dotnet restore Loterias.Shared/Loterias.Shared.csproj

      - name: Build Loterias.Shared
        run: dotnet build Loterias.Shared/Loterias.Shared.csproj --configuration Release --no-restore

      - name: Verify output (Shared)
        run: |
          echo "âœ… Build concluÃ­do: Loterias.Shared"
          ls -l Loterias.Shared/bin/Release/net8.0/ || true

      # ðŸ§© Build Loterias.Logging.Common
      - name: Restore dependencies (Loterias.Logging.Common)
        run: dotnet restore Loterias.Logging.Common/Loterias.Logging.Common.csproj

      - name: Build Loterias.Logging.Common
        run: dotnet build Loterias.Logging.Common/Loterias.Logging.Common.csproj --configuration Release --no-restore

      - name: Verify output (Logging.Common)
        run: |
          echo "âœ… Build concluÃ­do: Loterias.Logging.Common"
          ls -l Loterias.Logging.Common/bin/Release/net8.0/ || true
